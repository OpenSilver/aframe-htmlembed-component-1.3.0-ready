(()=>{var e={918:(e,t,s)=>{if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");const i=s(997);AFRAME.registerComponent("htmlembed",{schema:{ppu:{type:"number",default:256}},init:function(){this._onRaycasterIntersected=AFRAME.utils.bind(this._onRaycasterIntersected,this),this._onRaycasterIntersectedCleared=AFRAME.utils.bind(this._onRaycasterIntersectedCleared,this),this._onMouseDown=AFRAME.utils.bind(this._onMouseDown,this),this._onMouseUp=AFRAME.utils.bind(this._onMouseUp,this);let e=new i(this.el,(()=>{t&&(t.needsUpdate=!0)}),((e,t)=>{switch(e){case"resize":this.el.emit("resize");break;case"rendered":this.el.emit("rendered");break;case"focusableenter":this.el.emit("focusableenter",t);break;case"focusableleave":this.el.emit("focusableleave",t);break;case"inputrequired":this.el.emit("inputrequired",t)}}));this.htmlcanvas=e;let t=new THREE.Texture(e.canvas);t.minFilter=THREE.LinearFilter,t.wrapS=THREE.ClampToEdgeWrapping,t.wrapT=THREE.ClampToEdgeWrapping;const s=new THREE.MeshBasicMaterial({map:t,transparent:!0});let n=new THREE.PlaneGeometry,a=new THREE.Mesh(n,s);this.el.setObject3D("screen",a),this.screen=a,this.resize()},play:function(){this.el.addEventListener("raycaster-intersected",this._onRaycasterIntersected),this.el.addEventListener("raycaster-intersected-cleared",this._onRaycasterIntersectedCleared),this.el.addEventListener("mousedown",this._onMouseDown),this.el.addEventListener("mouseup",this._onMouseUp)},pause:function(){this.el.removeEventListener("raycaster-intersected",this._onRaycasterIntersected),this.el.removeEventListener("raycaster-intersected-cleared",this._onRaycasterIntersectedCleared),this.el.removeEventListener("mousedown",this._onMouseDown),this.el.removeEventListener("mouseup",this._onMouseUp)},_onRaycasterIntersected:function(e){this.raycaster=e.detail.el},_onRaycasterIntersectedCleared:function(e){this.htmlcanvas.clearHover(),this.raycaster=null},_onMouseDown:function(e){e instanceof CustomEvent?this.htmlcanvas.mousedown(this.lastX,this.lastY):e.stopPropagation()},_onMouseUp:function(e){e instanceof CustomEvent?this.htmlcanvas.mouseup(this.lastX,this.lastY):e.stopPropagation()},resize(){this.width=this.htmlcanvas.width/this.data.ppu,this.height=this.htmlcanvas.height/this.data.ppu,this.screen.scale.x=Math.max(1e-4,this.width),this.screen.scale.y=Math.max(1e-4,this.height)},update(){this.resize()},forceRender(){this.htmlcanvas.forceRender()},tick:function(){if(this.resize(),!this.raycaster)return;let e=this.raycaster.components.raycaster.getIntersection(this.el);if(!e)return;let t=e.point;this.el.object3D.worldToLocal(t);let s=this.width/2,i=this.height/2,n=Math.round((t.x+s)/this.width*this.htmlcanvas.canvas.width),a=Math.round((1-(t.y+i)/this.height)*this.htmlcanvas.canvas.height);this.lastX==n&&this.lastY==a||this.htmlcanvas.mousemove(n,a),this.lastX=n,this.lastY=a},remove:function(){console.log("remove"),this.el.removeObject3D("screen"),this.htmlcanvas.cleanUp(),this.htmlcanvas=null}})},997:e=>{!function(){let e=document.createElement("style");e.innerHTML="input, select,textarea{border: 1px solid #000000;margin: 0;background-color: #ffffff;-webkit-appearance: none;}:-webkit-autofill {color: #fff !important;}input[type='checkbox']{width: 20px;height: 20px;display: inline-block;}input[type='radio']{width: 20px;height: 20px;display: inline-block;border-radius: 50%;}input[type='checkbox'][checked],input[type='radio'][checked]{background-color: #555555;}a-entity[htmlembed] img{display:inline-block}a-entity[htmlembed]{display:none}";let t=document.querySelector("head");t.insertBefore(e,t.firstChild)}();class t{constructor(e,t,s){if(!e)throw"Container Element is Required";let i;this.updateCallback=t,this.eventCallback=s,this.onImageLoad=this.onImageLoad.bind(this),this.onMouseMoveHtml=this.onMouseMoveHtml.bind(this),this.onHashChangeEvent=this.onHashChangeEvent.bind(this),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.html=e,this.html.style.display="block",this.width=0,this.height=0,this.html.style.display="none",this.html.style.position="absolute",this.html.style.top="0",this.html.style.left="0",this.html.style.overflow="hidden",this.html.addEventListener("mousemove",this.onMouseMoveHtml),window.addEventListener("hashchange",this.onHashChangeEvent,!1),this.overElements=[],this.focusElement=null,this.img=new Image,this.img.addEventListener("load",this.onImageLoad),this.csshack();let n=new MutationObserver(((e,t)=>{if(!this.nowatch)for(let t=0;t<e.length;t++)if(e[t].target!=this.html||"attributes"!=e[t].type){if(!e[t].target.styleRef||"class"==e[t].attributeName){let s=this.csssig(e[t].target);if(e[t].target.styleRef==s)continue;e[t].target.styleRef=s}i||(i=setTimeout((()=>{this.svgToImg(),i=!1})))}}));n.observe(this.html,{attributes:!0,childList:!0,subtree:!0}),this.observer=n,this.cssgenerated=[],this.cssembed=[],this.serializer=new XMLSerializer,this.hashChanged()}onImageLoad(){this.render()}onMouseMoveHtml(e){e.stopPropagation()}onHashChangeEvent(){this.hashChanged()}forceRender(){Array.from(document.querySelectorAll("*")).map((e=>e.classCache={})),this.svgToImg()}hashChanged(){if(window.clearedHash!=window.location.hash){Array.from(document.querySelectorAll("*")).map((e=>e.classCache={}));let e=document.querySelector(".targethack");if(e&&e.classList.remove("targethack"),window.location.hash){let e=document.querySelector(window.location.hash);e&&e.classList.add("targethack")}}window.clearedHash=window.location.hash,this.svgToImg()}cleanUp(){console.log("cleanUp"),this.observer.disconnect(),window.removeEventListener("hashchange",this.onHashChangeEvent),this.html.removeEventListener("mousemove",this.onMouseMoveHtml),this.img.removeEventListener("load",this.onImageLoad),this.canvas.remove()}static regexpHover=new RegExp(":hover","g");static regexpActive=new RegExp(":active","g");static regexpFocus=new RegExp(":focus","g");static regexpTarget=new RegExp(":target","g");csshack(){let e=document.styleSheets;console.log("sheets.length",e.length);for(let s=0;s<e.length;s++)try{let i=e[s].cssRules,n=[];for(let e=0;e<i.length;e++){i[e].cssText.indexOf(":hover")>-1&&n.push(i[e].cssText.replace(t.regexpHover,".hoverhack")),i[e].cssText.indexOf(":active")>-1&&n.push(i[e].cssText.replace(t.regexpActive,".activehack")),i[e].cssText.indexOf(":focus")>-1&&n.push(i[e].cssText.replace(t.regexpFocus,".focushack")),i[e].cssText.indexOf(":target")>-1&&n.push(i[e].cssText.replace(t.regexpTarget,".targethack"));let s=n.indexOf(i[e].cssText);s>-1&&n.splice(s,1)}for(let t=0;t<n.length;t++)e[s].insertRule(n[t])}catch(e){}}dbj2(e){let t,s=5381;for(let i=0;i<e.length;i++)t=e.charCodeAt(i),s=(s<<5)+s+t;return s}csssig(e){if(e.classCache||(e.classCache={}),!e.classCache[e.className]){let t=getComputedStyle(e),s="";for(let e=0;e<t.length;e++)s+=t[t[e]];e.classCache[e.className]=this.dbj2(s)}return e.classCache[e.className]}arrayBufferToBase64(e){let t="",s=e.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(e[i]);return window.btoa(t)}embedCss(e,t){return new Promise((s=>{let i,n=[];t=(t=(t=(t=t.replace(new RegExp(":hover","g"),".hoverhack")).replace(new RegExp(":active","g"),".activehack")).replace(new RegExp(":focus","g"),".focushack")).replace(new RegExp(":target","g"),".targethack");const a=RegExp(/url\((?!['"]?(?:data):)['"]?([^'"\)]*)['"]?\)/gi);for(;i=a.exec(t);)n.push(this.getDataURL(new URL(i[1],e)).then((e=>s=>{t=t.replace(e[1],s)})(i)));Promise.all(n).then((e=>{s(t)}))}))}getURL(e){return e=new URL(e,window.location).href,new Promise((t=>{let s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer",s.onload=()=>{t(s)},s.send()}))}generatePageCSS(){let e=Array.from(document.querySelectorAll("style, link[type='text/css'],link[rel='stylesheet']")),t=[];for(let s=0;s<e.length;s++){let i=(new Date).getMilliseconds(),n=e[s];if(-1==this.cssgenerated.indexOf(n)){console.log(`before csshack: ${(new Date).getMilliseconds()-i} ms`),this.csshack(),console.log(`after csshack: ${(new Date).getMilliseconds()-i} ms`);let e=this.cssgenerated.length;this.cssgenerated.push(n),"STYLE"==n.tagName?t.push(this.embedCss(window.location,n.innerHTML).then(((e,t)=>e=>{this.cssembed[t]=e})(0,e))):t.push(this.getURL(n.getAttribute("href")).then((e=>t=>{let s=new TextDecoder("utf-8").decode(t.response);return this.embedCss(window.location,s).then(((e,t)=>e=>{this.cssembed[t]=e})(0,e))})(e)))}}return Promise.all(t)}getDataURL(e){return new Promise((t=>{this.getURL(e).then((s=>{let i=new Uint8Array(s.response),n=s.getResponseHeader("Content-Type").split(";")[0];if("text/css"==n){let s=new TextDecoder("utf-8").decode(i);this.embedCss(e,s).then((e=>{let s=window.btoa(e);s.length>0?t("data:"+n+";base64,"+s):t("")}))}else{let e=this.arrayBufferToBase64(i);t("data:"+n+";base64,"+e)}}))}))}embededSVG(){let e=[],t=this.html.querySelectorAll("*");for(let s=0;s<t.length;s++){let i=t[s].getAttributeNS("http://www.w3.org/1999/xlink","href");if(i&&e.push(this.getDataURL(i).then((e=>t=>{e.removeAttributeNS("http://www.w3.org/1999/xlink","href"),e.setAttribute("href",t)})(t[s]))),"IMG"==t[s].tagName&&"data"!=t[s].src.substr(0,4)&&e.push(this.getDataURL(t[s].src).then((e=>t=>{e.setAttribute("src",t)})(t[s]))),"http://www.w3.org/1999/xhtml"==t[s].namespaceURI&&t[s].hasAttribute("style")){let i=t[s].getAttribute("style");e.push(this.embedCss(window.location,i).then(((e,t)=>s=>{e!=s&&t.setAttribute("style",s)})(i,t[s])))}}let s=this.html.querySelectorAll("style");for(let t=0;t<s.length;t++)e.push(this.embedCss(window.location,s[t].innerHTML).then((e=>t=>{e.innerHTML!=t&&(e.innerHTML=t)})(s[t])));return Promise.all(e)}updateFocusBlur(){let e=this.html.querySelectorAll("*");for(let t=0;t<e.length;t++){let s=e[t];s.tabIndex>-1?(s.hasOwnProperty("focus")||(s.focus=(e=>()=>this.setFocus(e))(s)),s.hasOwnProperty("blur")||(s.blur=(e=>()=>this.focusElement==e&&this.setBlur())(s))):(delete s.focus,delete s.blur)}}getParents(){let e=[],t=[],s=this.html.parentNode;if(s)do{let i=s.tagName.toLowerCase();"a-"==i.substr(0,2)&&(i="div");let n="<"+("body"==i?'body xmlns="http://www.w3.org/1999/xhtml"':i)+' style="transform: none;left: 0;top: 0;position:static;display: block" class="'+s.className+'"'+(s.id?' id="'+s.id+'"':"")+">";e.unshift(n);let a="</"+i+">";if(t.push(a),"body"==i)break}while(s=s.parentNode);return[e.join(""),t.join("")]}updateCheckedAttributes(){let e=this.html.getElementsByTagName("input");for(let t=0;t<e.length;t++){let s=e[t];s.hasAttribute("checked")?s.checked||s.removeAttribute("checked"):s.checked&&s.setAttribute("checked","")}}svgToImg(){this.updateFocusBlur(),Promise.all([this.embededSVG(),this.generatePageCSS()]).then((()=>{this.html.style.display="block",this.width==this.html.offsetWidth&&this.height==this.html.offsetHeight||(this.width=this.html.offsetWidth,this.height=this.html.offsetHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.eventCallback&&this.eventCallback("resized"));let e=this.serializer.serializeToString(this.html),t=this.getParents();e='<svg width="'+this.width+'" height="'+this.height+'" xmlns="http://www.w3.org/2000/svg"><defs><style type="text/css"><![CDATA[a[href]{color:#0000EE;text-decoration:underline;}'+this.cssembed.join("")+']]></style></defs><foreignObject x="0" y="0" width="'+this.width+'" height="'+this.height+'">'+t[0]+e+t[1]+"</foreignObject></svg>",this.img.src="data:image/svg+xml;utf8,"+encodeURIComponent(e),this.html.style.display="none"}))}render(){this.canvas.width=this.width,this.canvas.height=this.height,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.img,0,0),this.updateCallback&&this.updateCallback(),this.eventCallback&&this.eventCallback("rendered")}transformPoint(e,t,s,i,n){let a=e.transform;if(0==a.indexOf("matrix(")){let e=new THREE.Matrix4,t=a.substring(7,a.length-1).split(", ").map(parseFloat);e.elements[0]=t[0],e.elements[1]=t[1],e.elements[4]=t[2],e.elements[5]=t[3],e.elements[12]=t[4],e.elements[13]=t[5]}else{if(0!=a.indexOf("matrix3d("))return[t,s,z];{let e=new THREE.Matrix4,t=a.substring(9,a.length-1).split(", ").map(parseFloat);e.elements=t}}let l=e["transform-origin"];l=l.replace(new RegExp("px","g"),"").split(" ").map(parseFloat);let h=i+l[0],o=n+l[1],r=0;l[2]&&(r+=l[2]);let c=(new THREE.Matrix4).makeTranslation(-h,-o,-r),d=(new THREE.Matrix4).makeTranslation(h,o,r);if(transform=d.multiply(transform).multiply(c),0!=transform.determinant())return[t,s];let u=(new THREE.Matrix4).getInverse(transform),m=new THREE.Vector3(t,s,0),f=new THREE.Vector3(t,s,-1);m.applyMatrix4(u),f.applyMatrix4(u);let p=f.sub(m).normalize();if(0==p.z)return!1;let v=p.multiplyScalar(-m.z/p.z).add(m);return[v.x,v.y]}getBorderRadii(e,t){let s,i=["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"],n=[];for(let e=0;e<i.length;e++){let a=t[i[e]],l=/(\d*)([a-z%]{1,3})/gi,h=[];for(;s=l.exec(a);)h.push({value:s[1],unit:s[2]});1==h.length&&h.push(h[0]),n.push(h)}const a={px:1,"%":e.offsetWidth/100};let l=[];for(let e=0;e<n.length;e++){let t=n[e],s=[];for(let e=0;e<t.length;e++)s.push(t[e].value*a[t[e].unit]);l.push(s)}let h,o=1,r=1,c=1,d=1,u=l[0][0]+l[1][0];u>e.offsetWidth&&(h=1/u*e.offsetWidth,o=Math.min(o,h),r=Math.min(r,h));let m=l[1][1]+l[2][1];m>e.offsetHeight&&(h=1/m*e.offsetHeight,c=Math.min(c,h),r=Math.min(r,h));let f=l[2][0]+l[3][0];f>e.offsetWidth&&(h=1/f*e.offsetWidth,c=Math.min(c,h),d=Math.min(d,h));let p=l[0][1]+l[3][1];return p>e.offsetHeight&&(h=1/p*e.offsetHeight,o=Math.min(o,h),d=Math.min(d,h)),l[0][0]=l[0][0]*o,l[0][1]=l[0][1]*o,l[1][0]=l[1][0]*r,l[1][1]=l[1][1]*r,l[2][0]=l[2][0]*c,l[2][1]=l[2][1]*c,l[3][0]=l[3][0]*d,l[3][1]=l[3][1]*d,l}checkInBorder(e,t,s,i,n,a){if("0px"==t["border-radius"])return!0;let l=e.offsetWidth,h=e.offsetHeight,o=this.getBorderRadii(e,t);if(s<o[0][0]+n&&i<o[0][1]+a){let e=(o[0][0]+n-s)/o[0][0],t=(o[0][1]+a-i)/o[0][1];if(e*e+t*t>1)return!1}if(s>n+l-o[1][0]&&i<o[1][1]+a){let e=(s-(n+l-o[1][0]))/o[1][0],t=(o[1][1]+a-i)/o[1][1];if(e*e+t*t>1)return!1}if(s>n+l-o[2][0]&&i>a+h-o[2][1]){let e=(s-(n+l-o[2][0]))/o[2][0],t=(i-(a+h-o[2][1]))/o[2][1];if(e*e+t*t>1)return!1}if(s<o[3][0]+n&&i>a+h-o[3][1]){let e=(o[3][0]+n-s)/o[3][0],t=(i-(a+h-o[3][1]))/o[3][1];if(e*e+t*t>1)return!1}return!0}checkElement(e,t,s,i,n,a,l,h){if(!l.offsetParent)return;let o=window.getComputedStyle(l),r=l.offsetLeft+s,c=l.offsetTop+i,d=l.offsetWidth,u=l.offsetHeight,m=o["z-index"];if("auto"!=m&&(n=0,a=parseInt(m)),"static"!=o.position&&l!=this.html&&"auto"==m&&(n+=1),("block"==o.display||"inline-block"==o.display)&&"none"!=o.transform){let s=this.transformPoint(o,e,t,r,c);if(!s)return;e=s[0],t=s[1],"auto"==m&&(n+=1)}if(e>r&&e<r+d&&t>c&&t<c+u)this.checkInBorder(l,o,e,t,r,c)&&(n>=h.zIndex||a>h.level)&&a>=h.level&&"none"!=o["pointer-events"]&&(h.zIndex=n,h.ele=l,h.level=a);else if("visible"!=o.overflow)return;let f=l.firstChild;if(f)do{1==f.nodeType&&(f.offsetParent==l?this.checkElement(e,t,s+r,i+c,n,a,f,h):this.checkElement(e,t,s,i,n,a,f,h))}while(f=f.nextSibling)}elementAt(e,t){this.html.style.display="block";let s={zIndex:0,ele:null,level:0};return this.checkElement(e,t,0,0,0,0,this.html,s),this.html.style.display="none",s.ele}moveMouse(){let e=this.moveX,t=this.moveY,s=this.moveButton,i={screenX:e,screenY:t,clientX:e,clientY:t,button:s||0,bubbles:!0,cancelable:!0},n={clientX:e,clientY:t,button:s||0,bubbles:!1},a=this.elementAt(e,t);if(a!=this.lastEle)if(a){a.tabIndex>-1&&this.eventCallback&&this.eventCallback("focusableenter",{target:a}),this.lastEle&&this.lastEle.tabIndex>-1&&this.eventCallback&&this.eventCallback("focusableleave",{target:this.lastEle});let e=[],t=a;this.lastEle&&this.lastEle.dispatchEvent(new MouseEvent("mouseout",i)),a.dispatchEvent(new MouseEvent("mouseover",i));do{if(t==this.html)break;-1==this.overElements.indexOf(t)&&(t.classList&&t.classList.add("hoverhack"),t.dispatchEvent(new MouseEvent("mouseenter",n)),this.overElements.push(t)),e.push(t)}while(t=t.parentNode);for(let t=0;t<this.overElements.length;t++){let s=this.overElements[t];-1==e.indexOf(s)&&(s.classList&&s.classList.remove("hoverhack"),s.dispatchEvent(new MouseEvent("mouseleave",n)),this.overElements.splice(t,1),t--)}}else for(;element=this.overElements.pop();)element.classList&&element.classList.remove("hoverhack"),element.dispatchEvent(new MouseEvent("mouseout",i));a&&-1==this.overElements.indexOf(a)&&this.overElements.push(a),this.lastEle=a,a&&a.dispatchEvent(new MouseEvent("mousemove",i)),this.moveTimer=!1}mousemove(e,t,s){this.moveX=e,this.moveY=t,this.moveButton=s,this.moveTimer||(this.moveTimer=setTimeout(this.moveMouse.bind(this),20))}mousedown(e,t,s){let i={screenX:e,screenY:t,clientX:e,clientY:t,button:s||0,bubbles:!0,cancelable:!0},n=this.elementAt(e,t);n&&(this.activeElement=n,n.classList.add("activehack"),n.classList.remove("hoverhack"),n.dispatchEvent(new MouseEvent("mousedown",i))),this.mousedownElement=n}setFocus(e){e.dispatchEvent(new FocusEvent("focus")),e.dispatchEvent(new CustomEvent("focusin",{bubbles:!0,cancelable:!1})),e.classList.add("focushack"),this.focusElement=e}setBlur(){this.focusElement&&(this.focusElement.classList.remove("focushack"),this.focusElement.dispatchEvent(new FocusEvent("blur")),this.focusElement.dispatchEvent(new CustomEvent("focusout",{bubbles:!0,cancelable:!1})))}clearHover(){let e;for(this.moveTimer&&(clearTimeout(this.moveTimer),this.moveTimer=!1);e=this.overElements.pop();)e.classList&&e.classList.remove("hoverhack"),e.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0}));this.lastEle&&this.lastEle.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!0,cancelable:!0})),this.lastEle=null;let t=document.querySelector(".activeElement");t&&(t.classList.remove("activehack"),this.activeElement=null)}mouseup(e,t,s){let i={screenX:e,screenY:t,clientX:e,clientY:t,button:s||0,bubbles:!0,cancelable:!0},n=this.elementAt(e,t);this.activeElement&&(this.activeElement.classList.remove("activehack"),n&&(n.classList.add("hoverhack"),-1==this.overElements.indexOf(n)&&this.overElements.push(n)),this.activeElement=null),n?(n.dispatchEvent(new MouseEvent("mouseup",i)),n!=this.focusElement&&(this.setBlur(),n.tabIndex>-1?this.setFocus(n):this.focusElement=null),n==this.mousedownElement&&(n.dispatchEvent(new MouseEvent("click",i)),"INPUT"==n.tagName&&this.updateCheckedAttributes(),"INPUT"!=n.tagName&&"TEXTAREA"!=n.tagName&&"SELECT"!=n.tagName||this.eventCallback&&this.eventCallback("inputrequired",{target:n}))):(this.focusElement&&this.focusElement.dispatchEvent(new FocusEvent("blur")),this.focusElement=null)}}e.exports=t}},t={};!function s(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,s),a.exports}(918)})();